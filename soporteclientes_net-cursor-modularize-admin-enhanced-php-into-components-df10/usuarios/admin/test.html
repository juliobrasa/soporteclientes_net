<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Kavia Admin Components</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS Modular -->
    <link rel="stylesheet" href="assets/css/admin-base.css">
    <link rel="stylesheet" href="assets/css/admin-components.css">
    <link rel="stylesheet" href="assets/css/admin-tables.css">
    <link rel="stylesheet" href="assets/css/admin-modals.css">
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-flask"></i> Test de Componentes Kavia</h1>
        <p>Prueba de todos los sistemas modulares</p>
    </div>

    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2>🧪 Pruebas de Sistema</h2>
            </div>
            <div class="card-body">
                <div class="grid grid-cols-3 gap-4">
                    <!-- Test Notificaciones -->
                    <div class="card">
                        <div class="card-body text-center">
                            <h3>📢 Notificaciones</h3>
                            <div class="flex flex-col gap-2">
                                <button class="btn btn-success btn-sm" onclick="testNotifications('success')">
                                    Success
                                </button>
                                <button class="btn btn-danger btn-sm" onclick="testNotifications('error')">
                                    Error
                                </button>
                                <button class="btn btn-warning btn-sm" onclick="testNotifications('warning')">
                                    Warning
                                </button>
                                <button class="btn btn-info btn-sm" onclick="testNotifications('info')">
                                    Info
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Test Modales -->
                    <div class="card">
                        <div class="card-body text-center">
                            <h3>🎭 Modales</h3>
                            <div class="flex flex-col gap-2">
                                <button class="btn btn-primary btn-sm" onclick="testModal()">
                                    Modal Simple
                                </button>
                                <button class="btn btn-warning btn-sm" onclick="testConfirm()">
                                    Confirmación
                                </button>
                                <button class="btn btn-info btn-sm" onclick="testAlert()">
                                    Alerta
                                </button>
                                <button class="btn btn-secondary btn-sm" onclick="testLoading()">
                                    Loading
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Test API -->
                    <div class="card">
                        <div class="card-body text-center">
                            <h3>🌐 API Client</h3>
                            <div class="flex flex-col gap-2">
                                <button class="btn btn-primary btn-sm" onclick="testAPICall()">
                                    Test API Call
                                </button>
                                <button class="btn btn-info btn-sm" onclick="testCache()">
                                    Test Cache
                                </button>
                                <button class="btn btn-warning btn-sm" onclick="clearAPICache()">
                                    Clear Cache
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Estado del Sistema -->
                <div class="card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <h3>📊 Estado del Sistema</h3>
                    </div>
                    <div class="card-body">
                        <div id="system-status">
                            <div class="loading-state">
                                <i class="fas fa-spinner fa-spin spinner"></i>
                                <h3>Verificando sistemas...</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Core -->
    <script src="assets/js/core/config.js"></script>
    <script src="assets/js/core/api-client.js"></script>
    <script src="assets/js/core/notification-system.js"></script>
    <script src="assets/js/core/modal-manager.js"></script>

    <script>
        // Funciones de prueba
        function testNotifications(type) {
            const messages = {
                success: 'Operación completada exitosamente',
                error: 'Ocurrió un error durante la operación',
                warning: 'Advertencia: verifica los datos',
                info: 'Información del sistema actualizada'
            };

            notificationSystem.show(type, messages[type]);
        }

        function testModal() {
            modalManager.open('test-modal', {
                title: 'Modal de Prueba',
                content: `
                    <p>Este es un modal de prueba del sistema modular.</p>
                    <p>Todas las funcionalidades están funcionando correctamente.</p>
                `,
                footer: `
                    <button class="btn btn-secondary" onclick="closeModal('test-modal')">Cerrar</button>
                    <button class="btn btn-primary" onclick="closeModal('test-modal')">Aceptar</button>
                `
            });
        }

        async function testConfirm() {
            const result = await modalManager.confirm(
                'Confirmar Acción',
                '¿Estás seguro de que quieres continuar con esta prueba?'
            );
            
            if (result) {
                showSuccess('Confirmado correctamente');
            } else {
                showInfo('Acción cancelada');
            }
        }

        async function testAlert() {
            await modalManager.alert(
                'Información del Sistema',
                'Todos los componentes están funcionando correctamente.'
            );
            showInfo('Alerta cerrada');
        }

        function testLoading() {
            modalManager.showLoading('Simulando operación...');
            
            setTimeout(() => {
                modalManager.hideLoading();
                showSuccess('Operación completada');
            }, 3000);
        }

        async function testAPICall() {
            try {
                showInfo('Realizando llamada API de prueba...');
                
                // Simular llamada API
                const result = await apiClient.call('test', { timestamp: Date.now() });
                
                if (result.success) {
                    showSuccess('API call exitosa');
                } else {
                    showWarning('API call falló: ' + result.error);
                }
            } catch (error) {
                showError('Error en API call: ' + error.message);
            }
        }

        function testCache() {
            const cacheSize = apiClient.cache.size;
            showInfo(`Cache actual: ${cacheSize} elementos`);
        }

        function clearAPICache() {
            apiClient.clearCache();
            showSuccess('Cache limpiado');
        }

        // Verificar estado del sistema
        function checkSystemStatus() {
            const statusDiv = document.getElementById('system-status');
            const systems = [
                { name: 'AdminConfig', status: typeof AdminConfig !== 'undefined' },
                { name: 'API Client', status: typeof apiClient !== 'undefined' },
                { name: 'Notification System', status: typeof notificationSystem !== 'undefined' },
                { name: 'Modal Manager', status: typeof modalManager !== 'undefined' }
            ];

            let statusHTML = '<div class="table-wrapper"><table class="table"><thead><tr><th>Sistema</th><th>Estado</th></tr></thead><tbody>';
            
            systems.forEach(system => {
                const statusBadge = system.status 
                    ? '<span class="status-badge status-active"><i class="fas fa-check"></i> Online</span>'
                    : '<span class="status-badge status-inactive"><i class="fas fa-times"></i> Error</span>';
                    
                statusHTML += `<tr><td><strong>${system.name}</strong></td><td>${statusBadge}</td></tr>`;
            });
            
            statusHTML += '</tbody></table></div>';
            
            statusDiv.innerHTML = statusHTML;
        }

        // Inicializar cuando esté listo
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🧪 Test page initialized');
            
            setTimeout(() => {
                checkSystemStatus();
                showSuccess('Sistema de pruebas inicializado correctamente');
            }, 1000);
        });
    </script>
</body>
</html>